<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>收集的几段实用函数，及其简单用法，应该对我们这些新手有用</title></head><body><h1>收集的几段实用函数，及其简单用法，应该对我们这些新手有用</h1><div><p>收集的几段实用函数，及其简单用法，应该对我们这些新手有用<br>1.过滤函数。<br>在表单提交时，有些人为了宣传一些的东西，在提交页面提交类似【&lt;a href="http//..."&gt;连接&lt;/a&gt;】的内容<br>我们不过滤读取出来数据就会以超级链接形式输出，我想这并不是我们希望，下面的代码可以实现读取时可以实现输出页的是提交原文，而不是超连接。<br>&lt;%<br>function th(str)<br>&nbsp;&nbsp;&nbsp; str=replace(str,"fuck","")<br>&nbsp;&nbsp;&nbsp; str = replace(str, "&gt;", "&amp;gt;")<br>&nbsp;&nbsp;&nbsp; str = replace(str, "&lt;", "&amp;lt;")<br>&nbsp;&nbsp;&nbsp; str = Replace(str, CHR(32), "&amp;nbsp;")<br>&nbsp;&nbsp;&nbsp; str = Replace(str, CHR(13), "")<br>&nbsp;&nbsp;&nbsp; str = Replace(str, CHR(10) &amp; CHR(10), "&lt;/P&gt;&lt;P&gt;")<br>&nbsp;&nbsp;&nbsp; str = Replace(str, CHR(10), "&lt;BR&gt;")<br>&nbsp;str = left(str,150)<br>th=str<br>end function<br>function th2(str)<br>&nbsp;&nbsp;&nbsp; str=replace(str,"fuck","")<br>&nbsp;&nbsp;&nbsp; str = replace(str, "&gt;", "&amp;gt;")<br>&nbsp;&nbsp;&nbsp; str = replace(str, "&lt;", "&amp;lt;")<br>&nbsp;&nbsp;&nbsp; str = Replace(str, CHR(32), "&amp;nbsp;")<br>&nbsp;&nbsp;&nbsp; str = Replace(str, CHR(13), "")<br>&nbsp;&nbsp;&nbsp; str = Replace(str, CHR(10) &amp; CHR(10), "&lt;/P&gt;&lt;P&gt;")<br>&nbsp;&nbsp;&nbsp; str = Replace(str, CHR(10), "&lt;BR&gt;")&nbsp; <br>th2=str<br>end function<br>%&gt;</p>
<p>在输出的页面引用函数 &lt;%=th2(rs("字段")) %&gt;</p>
<p>2.验证函数</p>
<p>(1).验证邮件格式<br>&lt;%<br>function IsValidEmail(email)<br>dim names, name, i, c<br>IsValidEmail = true<br>names = Split(email, "@")<br>if UBound(names) &lt;&gt; 1 then<br>&nbsp;&nbsp; IsValidEmail = false<br>&nbsp;&nbsp; exit function<br>end if<br>for each name in names<br>&nbsp;&nbsp; if Len(name) &lt;= 0 then<br>&nbsp;&nbsp;&nbsp;&nbsp; IsValidEmail = false<br>&nbsp;&nbsp;&nbsp;&nbsp; exit function<br>&nbsp;&nbsp; end if<br>&nbsp;&nbsp; for i = 1 to Len(name)<br>&nbsp;&nbsp;&nbsp;&nbsp; c = Lcase(Mid(name, i, 1))<br>&nbsp;&nbsp;&nbsp;&nbsp; if InStr("abcdefghijklmnopqrstuvwxyz_-.", c) &lt;= 0 and not IsNumeric(c) then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IsValidEmail = false<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; exit function<br>&nbsp;&nbsp;&nbsp;&nbsp; end if<br>&nbsp;&nbsp; next<br>&nbsp;&nbsp; if Left(name, 1) = "." or Right(name, 1) = "." then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IsValidEmail = false<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; exit function<br>&nbsp;&nbsp; end if<br>next<br>if InStr(names(1), ".") &lt;= 0 then<br>&nbsp;&nbsp; IsValidEmail = false<br>&nbsp;&nbsp; exit function<br>end if<br>i = Len(names(1)) - InStrRev(names(1), ".")<br>if i &lt;&gt; 2 and i &lt;&gt; 3 then<br>&nbsp;&nbsp; IsValidEmail = false<br>&nbsp;&nbsp; exit function<br>end if<br>if InStr(email, "..") &gt; 0 then<br>&nbsp;&nbsp; IsValidEmail = false<br>end if<br>end function<br>%&gt;<br>'''''''''''''下面从提交表单读取email值并赋值于mail''''''''''''<br>&lt;% mail=request.form("email")%&gt;</p>
<p>'''''''''''''调用函数 IsValidEmail() 并验证mail''''''''''''</p>
<p>&lt;% if mail&lt;&gt;"" and IsValidEmail(mail)=false then<br>&nbsp;&nbsp; response.write"&lt;Script Language=Javascript&gt;window.alert('email格式不正确！');history.go(-1);&lt;/Script&gt;"<br>&nbsp;&nbsp; response.end()<br>else<br>response.write"&lt;Script Language=Javascript&gt;window.alert('继续执行下面的代码，此处省略！');history.go(-1);&lt;/Script&gt;"<br>end if<br>%&gt;</p>
<p>(2).计算输入字符，并限制提交内容字数。<br>&lt;%<br>''把此段代码中所有【title】改为改为您要计算的表单项目名称<br>function strlen(title) <br>dim p_len <br>p_len=0 <br>strlen=0 <br>if trim(title)&lt;&gt;"" then <br>p_len=len(trim(title)) <br>for xx=1 to p_len <br>if asc(mid(title,xx,1))&lt;0 then <br>strlen=int(strlen) + 2 <br>else <br>strlen=int(strlen) + 1 <br>end if <br>next <br>end if <br>end function </p>
<p>function strvalue(title,lennum) <br>dim p_num <br>dim i <br>if strlen(title)&lt;=lennum then <br>strvalue=title<br>else <br>p_num=0 <br>x=0 <br>do while not p_num &gt; lennum-2 <br>x=x+1 <br>if asc(mid(title,x,1))&lt;0 then <br>p_num=int(p_num) + 2 <br>else <br>p_num=int(p_num) + 1 <br>end if <br>strvalue=left(trim(title),x)&amp;"…" <br>loop <br>end if <br>end function <br>%&gt;</p>
<p>函数strlen()调用并验证长度：<br>&lt;% <br>If strlen(title)=0 then<br>response.write "(&lt;Script&gt;window.alert('请输入标题！');history.go(-1);&lt;/Script&gt;)"<br>end if<br>%&gt;<br>&lt;% <br>If strlen(title)&gt;20 then<br>response.write "您已经输入"&amp;strlen(title)/2&amp;"个汉字。&lt;Script&gt;window.alert('标题太长不能超过10个汉字！');history.go(-1);&lt;/Script&gt;)"<br>end if<br>%&gt;</p>
<p>3.简单的加密函数<br>虽然MD5加密比较牛叉，但对新手认识ASP还是比较有帮助的，下面这段代码实现提交“纯数字类型”密码进行加密，制作后台时可以用<br>&lt;%<br>function encrypt(ecode)<br>&nbsp;Dim texts<br>&nbsp;dim i<br>&nbsp;for i=1 to len(ecode)<br>&nbsp;texts=texts &amp; chr(asc(mid(ecode,i,2))+i)<br>&nbsp;next<br>&nbsp;encrypt = texts<br>end function<br>%&gt;</p>
<p>调用举例<br>&lt;%<br>dim a,b,c,d<br>a=345<br>c=encrypt(a)<br>%&gt;<br>看看C=&lt;%=c%&gt;和&lt;%=a%&gt;有什么不同，<br>至于此段用于做后台密码加密各位自己去研究了。</p>
<p>【柳子木制作】</p>
<p>&nbsp;</p></div></body></html>