<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>我的第一个程序：VB计算器，付代码</title></head><body><h1>我的第一个程序：VB计算器，付代码</h1><div><p>&nbsp; &nbsp;无聊就在网上下载教程来看，偶然间下载了某个学院的一个VB6.0的课件，于是花五六个晚上研究着玩，于是萌发了自己搞个计算器试试的想法，想法有，自然就要百度啦。，呵呵，经过一个星期后，经过昨晚的五六小时的奋战，加上今天早上的修改，终于做了一个自己满意的简单计算器，有兴趣的下载玩玩，代码如下：</p><p></p><p></p><p></p><p><span style="color: #ff0000;">&nbsp;</span><span style="color: #ff0000;">Option Explicit</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; Dim lastinput As String '指示上一次按键事件的类型</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; Dim opttype As Integer '按了那个符号</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; Dim keynum As Integer</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; Private t As Boolean</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; Private s As Boolean</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Private Sub Command11_KeyPress(Index As Integer, KeyAscii As Integer)</span></p><p><span style="color: #ff0000;">If KeyAscii = 13 Then</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Text2.SetFocus</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; &nbsp; End If</span></p><p><span style="color: #ff0000;">End Sub</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Private Sub Command20_Click()</span></p><p><span style="color: #ff0000;">On Error Resume Next</span></p><p><span style="color: #ff0000;">If IsNumeric(Text3.Text) Then</span></p><p><span style="color: #ff0000;">Text3.Text = Sin(Val(Text3.Text) * 3.1415926 / 180)</span></p><p><span style="color: #ff0000;">Else</span></p><p><span style="color: #ff0000;">Frame1.Caption = &quot;C值必须是数字！&quot;</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">Text3.SetFocus '焦点</span></p><p><span style="color: #ff0000;">End Sub</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Private Sub Command21_Click()</span></p><p><span style="color: #ff0000;">On Error Resume Next</span></p><p><span style="color: #ff0000;">If IsNumeric(Text3.Text) Then</span></p><p><span style="color: #ff0000;">Text3.Text = Cos(Val(Text3.Text) * 3.1415926 / 180)</span></p><p><span style="color: #ff0000;">Else</span></p><p><span style="color: #ff0000;">Frame1.Caption = &quot;C值必须是数字！&quot;</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">Text3.SetFocus '焦点</span></p><p><span style="color: #ff0000;">End Sub</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Private Sub Command22_Click()</span></p><p><span style="color: #ff0000;">On Error Resume Next</span></p><p><span style="color: #ff0000;">If IsNumeric(Text3.Text) Then</span></p><p><span style="color: #ff0000;">Text3.Text = Tan(Val(Text3.Text) * 3.1415926 / 180)</span></p><p><span style="color: #ff0000;">Else</span></p><p><span style="color: #ff0000;">Frame1.Caption = &quot;C值必须是数字！&quot;</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">Text3.SetFocus '焦点</span></p><p><span style="color: #ff0000;">End Sub</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Private Sub Command23_Click()</span></p><p><span style="color: #ff0000;">On Error Resume Next</span></p><p><span style="color: #ff0000;">If IsNumeric(Text3.Text) Then</span></p><p><span style="color: #ff0000;">Text3.Text = Atn(Val(Text3.Text) * 3.1415926 / 180)</span></p><p><span style="color: #ff0000;">Else</span></p><p><span style="color: #ff0000;">Frame1.Caption = &quot;C值必须是数字！&quot;</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">Text3.SetFocus '焦点</span></p><p><span style="color: #ff0000;">End Sub</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Private Sub Command24_Click()</span></p><p><span style="color: #ff0000;">On Error Resume Next</span></p><p><span style="color: #ff0000;">If IsNumeric(Text3.Text) Then</span></p><p><span style="color: #ff0000;">Text3.Text = Val(Text3.Text) * Val(Text3.Text)</span></p><p><span style="color: #ff0000;">Else</span></p><p><span style="color: #ff0000;">Frame1.Caption = &quot;C值必须是数字！&quot;</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">Text3.SetFocus '焦点</span></p><p><span style="color: #ff0000;">End Sub</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Private Sub Command25_Click()</span></p><p><span style="color: #ff0000;">On Error Resume Next</span></p><p><span style="color: #ff0000;">If IsNumeric(Text3.Text) Then</span></p><p><span style="color: #ff0000;">&nbsp; If Len(Trim(Text3.Text)) &gt; 0 And Text3.Text &gt; 0 Then</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; &nbsp; Text3.Text = Sqr(Val(Text3.Text)) '运用Sqr函数</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Else</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; &nbsp; MsgBox &quot;被开方数C不能为负数&quot;, 0 + 48, &quot;提示信息&quot; '被开方数为负数时提示错误</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; &nbsp;End If</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; lastinput = &quot;num&quot;</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; Else</span></p><p><span style="color: #ff0000;">Frame1.Caption = &quot;C值必须是数字！&quot;</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; Text3.SetFocus '焦点</span></p><p><span style="color: #ff0000;">End Sub</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Private Sub Command26_Click()</span></p><p><span style="color: #ff0000;">On Error Resume Next</span></p><p><span style="color: #ff0000;">If IsNumeric(Text3.Text) Then</span></p><p><span style="color: #ff0000;">If Val(Text3.Text) &gt; 0 Then</span></p><p><span style="color: #ff0000;">Text3.Text = Log(Val(Text3.Text)) / Log(10)</span></p><p><span style="color: #ff0000;">Else</span></p><p><span style="color: #ff0000;">&nbsp; Frame1.Caption = &quot; C必须是正数&quot;</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">Else</span></p><p><span style="color: #ff0000;">Frame1.Caption = &quot;C值必须是数字！&quot;</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">Text3.SetFocus '焦点</span></p><p><span style="color: #ff0000;">End Sub</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Private Sub Command27_Click()</span></p><p><span style="color: #ff0000;">On Error Resume Next</span></p><p><span style="color: #ff0000;">Text1.Text =“”</span></p><p><span style="color: #ff0000;">Text2.Text = “”</span></p><p><span style="color: #ff0000;">Text3.Text = Val(3.1415926535)</span></p><p><span style="color: #ff0000;">Text3.Text = Format(Val(Text3.Text), &quot;0.###############################&quot;)</span></p><p><span style="color: #ff0000;">Frame1.Caption = &quot;圆周率值为：&quot;</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp;Text3.SetFocus '焦点</span></p><p><span style="color: #ff0000;">End Sub</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Private Sub Command28_Click()</span></p><p><span style="color: #ff0000;">End</span></p><p><span style="color: #ff0000;">End Sub</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Private Sub Command29_Click()</span></p><p><span style="color: #ff0000;">On Error Resume Next</span></p><p><span style="color: #ff0000;">If IsNumeric(Text3.Text) Then</span></p><p><span style="color: #ff0000;">Text3.Text = 1 / Text3.Text</span></p><p><span style="color: #ff0000;">Else</span></p><p><span style="color: #ff0000;">Frame1.Caption = &quot;C值必须是数字！&quot;</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">Text3.SetFocus '焦点</span></p><p><span style="color: #ff0000;">End Sub</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Private Sub Command6_Click() '正负转换</span></p><p><span style="color: #ff0000;">On Error Resume Next</span></p><p><span style="color: #ff0000;">If s = False Then</span></p><p><span style="color: #ff0000;">&nbsp; If t = True Then</span></p><p><span style="color: #ff0000;">Text1.Text = Trim(Str(-Val(Text1.Text)))</span></p><p><span style="color: #ff0000;">If Val(Text1.Text) &lt; 1 And Val(Text1.Text) &gt; 0 Then</span></p><p><span style="color: #ff0000;">Text1.Text = Format(Val(Text1.Text), &quot;0.###########################&quot;)</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">If t = False Then</span></p><p><span style="color: #ff0000;">Text2.Text = Trim(Str(-Val(Text2.Text)))</span></p><p><span style="color: #ff0000;">If Val(Text2.Text) &lt; 1 And Val(Text2.Text) &gt; 0 Then</span></p><p><span style="color: #ff0000;">Text2.Text = Format(Val(Text2.Text), &quot;0.###########################&quot;)</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">If s = True Then</span></p><p><span style="color: #ff0000;">Text3.Text = Trim(Str(-Val(Text3.Text)))</span></p><p><span style="color: #ff0000;">If Val(Text3.Text) &lt; 1 And Val(Text3.Text) &gt; 0 Then</span></p><p><span style="color: #ff0000;">Text3.Text = Format(Val(Text3.Text), &quot;0.###########################&quot;)</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">End Sub</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Private Sub Command7_Click() '下面是清除键CE的代码</span></p><p><span style="color: #ff0000;">Text1.Text = &quot;&quot;</span></p><p><span style="color: #ff0000;">Text2.Text = &quot;&quot;</span></p><p><span style="color: #ff0000;">Text3.Text = &quot;&quot;</span></p><p><span style="color: #ff0000;">Text1.SetFocus '焦点</span></p><p><span style="color: #ff0000;">End Sub</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Private Sub Command8_Click() 'Backspace退格键</span></p><p><span style="color: #ff0000;">If s = False Then</span></p><p><span style="color: #ff0000;">If t = True Then</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; If Len(Text1.Text) &gt; 1 Then</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; Text1.Text = Left(Text1.Text, Len(Text1.Text) - 1)</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; Else</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; If Len(Text1.Text) = 1 Then</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; Text1.Text = 0</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; Else</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; MsgBox &quot; 已经是最后一位了&quot;, 0 + 48, &quot;提示信息&quot;</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; End If</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; End If</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">If t = False Then</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; If Len(Text2.Text) &gt; 1 Then</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; Text2.Text = Left(Text2.Text, Len(Text2.Text) - 1)</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; Else</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; If Len(Text2.Text) = 1 Then</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; Text2.Text = 0</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; Else</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; MsgBox &quot; 已经是最后一位了&quot;, 0 + 48, &quot;提示信息&quot;</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; End If</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; End If</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; End If</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; End If</span></p><p><span style="color: #ff0000;">If s = True Then</span></p><p><span style="color: #ff0000;">If Len(Text3.Text) &gt; 1 Then</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; Text3.Text = Left(Text3.Text, Len(Text3.Text) - 1)</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; Else</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; If Len(Text3.Text) = 1 Then</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; Text3.Text = 0</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; Else</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; MsgBox &quot; 已经是最后一位了&quot;, 0 + 48, &quot;提示信息&quot;</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; End If</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; End If</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; End If</span></p><p><span style="color: #ff0000;">End Sub</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Private Sub Command9_Click()</span></p><p><span style="color: #ff0000;">On Error Resume Next</span></p><p><span style="color: #ff0000;">If IsNumeric(Text1.Text) And IsNumeric(Text2.Text) Then</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; Text3.Text = Val(Text1.Text) Mod Val(Text2.Text)</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; &nbsp;Frame1.Caption = &quot;取模值为：&quot;</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; If Text2.Text = 0 Then</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp;Frame1.Caption = &quot;除数B不能为零！&quot;</span></p><p><span style="color: #ff0000;">&nbsp;&nbsp;</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp;End If</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp;Else</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp;Frame1.Caption = &quot;A和B的值必为数字！&quot;</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp;End If</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp;Text2.SetFocus '焦点</span></p><p><span style="color: #ff0000;">End Sub</span></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p><span style="color: #ff0000;">Private Sub Form_Activate()</span></p><p><span style="color: #ff0000;">Text1.SetFocus</span></p><p><span style="color: #ff0000;">End Sub</span></p><p>&nbsp;</p><p>&nbsp;</p><p><span style="color: #ff0000;">Private Sub Text1_GotFocus() '焦点在TEXT1</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; t = True</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; s = False</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; Text1.SelStart = Len(Text1.Text)</span></p><p><span style="color: #ff0000;">End Sub</span></p><p>&nbsp;</p><p>&nbsp;</p><p><span style="color: #ff0000;">Private Sub Text2_GotFocus() '焦点在TEXT2</span></p><p><span style="color: #ff0000;">&nbsp; t = False</span></p><p><span style="color: #ff0000;">&nbsp; s = False</span></p><p><span style="color: #ff0000;">&nbsp; Text2.SelStart = Len(Text2.Text)</span></p><p><span style="color: #ff0000;">&nbsp; End Sub</span></p><p><span style="color: #ff0000;">Private Sub Command1_Click()</span></p><p><span style="color: #ff0000;">On Error Resume Next</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp;If IsNumeric(Text1.Text) And IsNumeric(Text2.Text) Then</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; Text3.Text = Val(Text1.Text) + Val(Text2.Text)</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; Frame1.Caption = &quot;相加的结果为：&quot;</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp;Else</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; Frame1.Caption = &quot;A和B的值必为数字！&quot;</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp;End If</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp;Text1.SetFocus '焦点</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp;End Sub</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Private Sub Command10_Click(Index As Integer)</span></p><p><span style="color: #ff0000;">If s = False Then</span></p><p><span style="color: #ff0000;">If t = True Then</span></p><p><span style="color: #ff0000;">Text1.Text = Text1.Text + &quot;0&quot;</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">If t = False Then</span></p><p><span style="color: #ff0000;">Text2.Text = Text2.Text + &quot;0&quot;</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">If s = True Then</span></p><p><span style="color: #ff0000;">Text3.Text = Text3.Text + &quot;0&quot;</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">End Sub</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Private Sub Command11_Click(Index As Integer)</span></p><p><span style="color: #ff0000;">If s = False Then</span></p><p><span style="color: #ff0000;">If t = True Then</span></p><p><span style="color: #ff0000;">Text1.Text = Text1.Text + &quot;1&quot;</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">If t = False Then</span></p><p><span style="color: #ff0000;">Text2.Text = Text2.Text + &quot;1&quot;</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">If s = True Then</span></p><p><span style="color: #ff0000;">Text3.Text = Text3.Text + &quot;1&quot;</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">End Sub</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Private Sub Command12_Click(Index As Integer)</span></p><p><span style="color: #ff0000;">If s = False Then</span></p><p><span style="color: #ff0000;">If t = True Then</span></p><p><span style="color: #ff0000;">Text1.Text = Text1.Text + &quot;2&quot;</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">If t = False Then</span></p><p><span style="color: #ff0000;">Text2.Text = Text2.Text + &quot;2&quot;</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">If s = True Then</span></p><p><span style="color: #ff0000;">Text3.Text = Text3.Text + &quot;2&quot;</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">End Sub</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Private Sub Command13_Click(Index As Integer)</span></p><p><span style="color: #ff0000;">If s = False Then</span></p><p><span style="color: #ff0000;">If t = True Then</span></p><p><span style="color: #ff0000;">Text1.Text = Text1.Text + &quot;3&quot;</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">If t = False Then</span></p><p><span style="color: #ff0000;">Text2.Text = Text2.Text + &quot;3&quot;</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">If s = True Then</span></p><p><span style="color: #ff0000;">Text3.Text = Text3.Text + &quot;3&quot;</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">End Sub</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Private Sub Command14_Click(Index As Integer)</span></p><p><span style="color: #ff0000;">If s = False Then</span></p><p><span style="color: #ff0000;">If t = True Then</span></p><p><span style="color: #ff0000;">Text1.Text = Text1.Text + &quot;4&quot;</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">If t = False Then</span></p><p><span style="color: #ff0000;">Text2.Text = Text2.Text + &quot;4&quot;</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">If s = True Then</span></p><p><span style="color: #ff0000;">Text3.Text = Text3.Text + &quot;4&quot;</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">End Sub</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Private Sub Command15_Click(Index As Integer)</span></p><p><span style="color: #ff0000;">If s = False Then</span></p><p><span style="color: #ff0000;">If t = True Then</span></p><p><span style="color: #ff0000;">Text1.Text = Text1.Text + &quot;5&quot;</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">If t = False Then</span></p><p><span style="color: #ff0000;">Text2.Text = Text2.Text + &quot;5&quot;</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">If s = True Then</span></p><p><span style="color: #ff0000;">Text3.Text = Text3.Text + &quot;5&quot;</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">End Sub</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Private Sub Command16_Click(Index As Integer)</span></p><p><span style="color: #ff0000;">If s = False Then</span></p><p><span style="color: #ff0000;">If t = True Then</span></p><p><span style="color: #ff0000;">Text1.Text = Text1.Text + &quot;6&quot;</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">If t = False Then</span></p><p><span style="color: #ff0000;">Text2.Text = Text2.Text + &quot;6&quot;</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">If s = True Then</span></p><p><span style="color: #ff0000;">Text3.Text = Text3.Text + &quot;6&quot;</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">End Sub</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Private Sub Command17_Click(Index As Integer)</span></p><p><span style="color: #ff0000;">If s = False Then</span></p><p><span style="color: #ff0000;">If t = True Then</span></p><p><span style="color: #ff0000;">Text1.Text = Text1.Text + &quot;7&quot;</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">If t = False Then</span></p><p><span style="color: #ff0000;">Text2.Text = Text2.Text + &quot;7&quot;</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">If s = True Then</span></p><p><span style="color: #ff0000;">Text3.Text = Text3.Text + &quot;7&quot;</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">End Sub</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Private Sub Command18_Click(Index As Integer)</span></p><p><span style="color: #ff0000;">If s = False Then</span></p><p><span style="color: #ff0000;">If t = True Then</span></p><p><span style="color: #ff0000;">Text1.Text = Text1.Text + &quot;8&quot;</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">If t = False Then</span></p><p><span style="color: #ff0000;">Text2.Text = Text2.Text + &quot;8&quot;</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">If s = True Then</span></p><p><span style="color: #ff0000;">Text3.Text = Text3.Text + &quot;8&quot;</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">End Sub</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Private Sub Command19_Click(Index As Integer)</span></p><p><span style="color: #ff0000;">If s = False Then</span></p><p><span style="color: #ff0000;">If t = True Then</span></p><p><span style="color: #ff0000;">Text1.Text = Text1.Text + &quot;9&quot;</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">If t = False Then</span></p><p><span style="color: #ff0000;">Text2.Text = Text2.Text + &quot;9&quot;</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">If s = True Then</span></p><p><span style="color: #ff0000;">Text3.Text = Text3.Text + &quot;9&quot;</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">End Sub</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Private Sub Command2_Click()</span></p><p><span style="color: #ff0000;">On Error Resume Next</span></p><p><span style="color: #ff0000;">If IsNumeric(Text1.Text) And IsNumeric(Text2.Text) Then</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; Text3.Text = Val(Text1.Text) - Val(Text2.Text)</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; &nbsp;Frame1.Caption = &quot;相减的结果为：&quot;</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp;Else</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; Frame1.Caption = &quot;A和B的值必为数字！&quot;</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp;End If</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp;Text1.SetFocus '焦点</span></p><p><span style="color: #ff0000;">End Sub</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Private Sub Command3_Click()</span></p><p><span style="color: #ff0000;">On Error Resume Next</span></p><p><span style="color: #ff0000;">If IsNumeric(Text1.Text) And IsNumeric(Text2.Text) Then</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; Text3.Text = Val(Text1.Text) * Val(Text2.Text)</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; &nbsp;Frame1.Caption = &quot;相乘的结果为：&quot;</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; &nbsp;Else</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; Frame1.Caption = &quot;A和B的值必为数字！&quot;</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp;End If</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp;Text1.SetFocus '焦点</span></p><p><span style="color: #ff0000;">End Sub</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Private Sub Command4_Click()</span></p><p><span style="color: #ff0000;">On Error Resume Next</span></p><p><span style="color: #ff0000;">If IsNumeric(Text1.Text) And IsNumeric(Text2.Text) Then</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; Text3.Text = Val(Text1.Text) / Val(Text2.Text)</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; &nbsp;Frame1.Caption = &quot;相除的结果为：&quot;</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; If Text2.Text = 0 Then</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp;Frame1.Caption = &quot;除数B不能为零！&quot;</span></p><p><span style="color: #ff0000;">&nbsp;&nbsp;</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp;End If</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp;Else</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp;Frame1.Caption = &quot;A和B的值必为数字！&quot;</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp;End If</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp;Text2.SetFocus '焦点</span></p><p><span style="color: #ff0000;">End Sub</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Private Sub Command5_Click() '小数点键</span></p><p><span style="color: #ff0000;">On Error Resume Next</span></p><p><span style="color: #ff0000;">If s = False Then</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp;If t = True Then</span></p><p><span style="color: #ff0000;">&nbsp; '如果数据位数超出范围或数据中已包含小数点，退出本过程</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; If Len(Text1.Text) &gt; 16 Or InStr(1, Text1.Text, &quot;.&quot;) &gt; 0 And lastinput &lt;&gt; &quot;eqv&quot; Then Exit Sub</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; '若以&quot;0&quot;开始输入，在“0”前加0</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; '若在数据尾部输入过程中按下“.”，直接将“.”追加在数据尾部</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; If lastinput = &quot;opt&quot; Or lastinput = &quot;eqv&quot; Or lastinput = &quot;neg&quot; Then</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; &nbsp; Text1.Text = Text1.Text + &quot;0.&quot;</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; Else</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; &nbsp; Text1.Text = Text1.Text + &quot;.&quot;</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; End If</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; End If</span></p><p><span style="color: #ff0000;">If t = False Then</span></p><p><span style="color: #ff0000;">&nbsp;'如果数据位数超出范围或数据中已包含小数点，退出本过程</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; If Len(Text2.Text) &gt; 16 Or InStr(1, Text2.Text, &quot;.&quot;) &gt; 0 And lastinput &lt;&gt; &quot;eqv&quot; Then Exit Sub</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; '若以&quot;0&quot;开始输入，在“0”前加0</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; '若在数据尾部输入过程中按下“.”，直接将“.”追加在数据尾部</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; If lastinput = &quot;opt&quot; Or lastinput = &quot;eqv&quot; Or lastinput = &quot;neg&quot; Then</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; &nbsp; Text2.Text = Text2.Text + &quot;0.&quot;</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; Else</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; &nbsp; Text2.Text = Text2.Text + &quot;.&quot;</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; End If</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">If s = True Then</span></p><p><span style="color: #ff0000;">&nbsp;'如果数据位数超出范围或数据中已包含小数点，退出本过程</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; If Len(Text3.Text) &gt; 16 Or InStr(1, Text3.Text, &quot;.&quot;) &gt; 0 And lastinput &lt;&gt; &quot;eqv&quot; Then Exit Sub</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; '若以&quot;0&quot;开始输入，在“0”前加0</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; '若在数据尾部输入过程中按下“.”，直接将“.”追加在数据尾部</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; If lastinput = &quot;opt&quot; Or lastinput = &quot;eqv&quot; Or lastinput = &quot;neg&quot; Then</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; &nbsp; Text3.Text = Text3.Text + &quot;0.&quot;</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; Else</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; &nbsp; Text3.Text = Text3.Text + &quot;.&quot;</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; End If</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; End If</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">End Sub</span></p><p><span style="color: #ff0000;">Private Sub Text3_GotFocus() '焦点在TEXT3</span></p><p><span style="color: #ff0000;">s = True</span></p><p><span style="color: #ff0000;">Text3.Text = Format(Text3.Text, &quot;0.0000000000&quot;)</span></p><p><span style="color: #ff0000;">Text3.SelStart = Len(Text1.Text)</span></p><p><span style="color: #ff0000;">End Sub</span></p><div><br /></div><p></p><p><span style="color: #000000;">当然借鉴各个论坛的高手们的方法，代码有许多类型不相配的错误，我就来个</span><span style="color: #ff0000;">On Error Resume Next<span style="color: #000000;">处理没能力一个个查咯。界面如下图</span></span></p><p><span><img src="http://hiphotos.baidu.com/super58/pic/item/5c03a8cd033521270db34548.jpg" small="0" /></span></p><p><span style="color: #000000;">下载地址顺便给同是新手的玩玩：</span><a href="http://3gqq.ys168.com/">http://3gqq.ys168.com/</a><span style="color: #000000;"><br /><br /></span></p><p></p><p></p></div></body></html>