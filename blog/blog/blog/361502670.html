<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>用几行Asp代码实现防止表单多次被提交</title></head><body><h1>用几行Asp代码实现防止表单多次被提交</h1><div><span class="Apple-style-span" style="font-family: 宋体; ">作者：廖家远<br><br>&nbsp; &nbsp; 在很多情况下都需要防止相同的表单被多次提交，很多人的实现方法都比较复杂(代码数量超过几十行！！)下面提供一种只需使用几行代码的方法，轻松地实现了防止用户刷新多次提交表单和使用后退钮重复多次提交表单。&nbsp;<br>表单文件formtest.asp&nbsp;<br>&nbsp; &nbsp; &lt; %Randomize &nbsp;'初始代随机数种子&nbsp;<br>&nbsp; &nbsp; num1=rnd() '产生随机数num1&nbsp;<br>&nbsp; &nbsp; num1=int(26*num1)+65 &nbsp;'修改num1的范围以使其是A-Z范围的Ascii码，以防表单名出错&nbsp;<br>&nbsp; &nbsp; session("antry")="test"&amp;chr(num1) &nbsp;'产生随机字符串&nbsp;<br>&nbsp; &nbsp; % &gt;&nbsp;<br>&nbsp; &nbsp; &lt; form name="test" action="testact.asp" method="post" &gt;&nbsp;<br>&nbsp; &nbsp; 你的名字：&lt; input type='text' name='' size=30 &gt; &nbsp; '注意本行中使用了随机表单项名&nbsp;<br>&nbsp; &nbsp; &lt; input type='submit' value='提交' &gt;&nbsp;<br>&nbsp; &nbsp; &lt; /form &gt;&nbsp;<br>表单处理程序testact.asp&nbsp;<br>&nbsp; &nbsp;&lt; %&nbsp;<br>&nbsp; &nbsp;teststr=request.form(session("antry"))&nbsp;<br>&nbsp; &nbsp;if teststr="" then&nbsp;<br>&nbsp; &nbsp; &nbsp; response.write "没有填写姓名或重复提交"&nbsp;<br>&nbsp; &nbsp; &nbsp; '由于用户没有填写名字，或表单被重复提交(标志为session("antry")为空)引起&nbsp;<br>&nbsp; &nbsp;else&nbsp;<br>&nbsp; &nbsp; &nbsp; response.write teststr&nbsp;<br>&nbsp; &nbsp; &nbsp; session("antry")="" &nbsp; &nbsp;'提交成功，清空session("antry")，以防重复提交！！&nbsp;<br>&nbsp; &nbsp;end if&nbsp;<br>&nbsp; &nbsp;% &gt;&nbsp;<br>&nbsp; &nbsp; 在这里，你只需随机化一个必填项目的表单项名即可，不必随机化所有的表单项目。&nbsp;</span><p></p></div></body></html>