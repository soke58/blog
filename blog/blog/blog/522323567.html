<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>VB判断网络连接情况</title></head><body><h1>VB判断网络连接情况</h1><div><p><span style="color: #ff0000;">模块中加入下面代码：</span></p><p>Public Declare Function InternetGetConnectedState Lib &quot;wininet.dll&quot; (ByRef dwflags As Long, ByVal dwReserved As Long) As Long<br /><br />'本系统处于离线状态<br />Public Const INTERNET_CONNECTION_OFFLINE As Long = &amp;H20<br /><br />'安装了RAS服务<br />Public Const INTERNET_RAS_INSTALLED As Long = &amp;H10<br /><br />'使用Modem与Internet相连<br />Public Const INTERNET_CONNECTION_MODEM As Long = &amp;H1<br /><br />'使用Proxy与Internet相连<br />Public Const INTERNET_CONNECTION_PROXY As Long = &amp;H4<br /><br />'未使用<br />Public Const INTERNET_CONNECTION_MODEM_BUSY As Long = &amp;H8<br /><br />'使用LAN与Internet相连<br />Public Const INTERNET_CONNECTION_LAN As Long = &amp;H2<br /><br />'主机有合法的Internet连接配置（但当前可能处于连接状态或离线状态）<br />Public Const INTERNET_CONNECTION_CONFIGURED As Long = &amp;H40</p><p>&nbsp;</p><p>Public Function GetConnectionString() As String<br />&nbsp; Dim dwflags As Long<br />&nbsp; Dim MyMsg As String<br />&nbsp; '显示的信息字符串<br />&nbsp;&nbsp;&nbsp;&nbsp; If InternetGetConnectedState(dwflags, 0&amp;) Then<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If dwflags And INTERNET_CONNECTION_CONFIGURED Then<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MyMsg = MyMsg + &quot;系统配置了网络连接&quot; + vbCrLf<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If dwflags And INTERNET_CONNECTION_LAN Then<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MyMsg = MyMsg + &quot;系统通过路由器与Internet连接&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If dwflags And INTERNET_CONNECTION_PROXY Then<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MyMsg = MyMsg + &quot;并使用了Proxy代理服务器&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MyMsg = MyMsg + &quot;。&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If dwflags And INTERNET_CONNECTION_MODEM Then<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MyMsg = MyMsg + &quot;系统使用Modem与Internet连接&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If dwflags And INTERNET_CONNECTION_OFFLINE Then<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MyMsg = MyMsg + &quot;系统当前处于离线状态&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If dwflags And INTERNET_CONNECTION_MODEM_BUSY Then<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MyMsg = MyMsg + &quot;系统通ADSL连接到网络&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If dwflags And INTERNET_RAS_INSTALLED Then<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MyMsg = MyMsg + &quot;系统安装了远程访问服务&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br />&nbsp;&nbsp;&nbsp;&nbsp; Else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MyMsg = &quot;系统当前未与Internet连接&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp; End If<br />&nbsp;&nbsp;&nbsp;&nbsp; GetConnectionString = MyMsg<br />End Function</p><p>&nbsp;</p><p><span style="color: #ff0000;">窗体中form代码：</span></p><p>Option Explicit<br />'API 函数声明<br />Private Declare Function InternetCheckConnection Lib &quot;wininet.dll&quot; Alias &quot;InternetCheckConnectionA&quot; (ByVal lpszUrl As String, ByVal dwflags As Long, ByVal dwReserved As Long) As Long</p><p>&nbsp;</p><p>Private Sub Form_Load()<br />&nbsp;If InternetCheckConnection(&quot;http://www.baidu.com/&quot;, 1, 0) = 0 Then<br />&nbsp;&nbsp;&nbsp;&nbsp; msgbox&nbsp; &quot;网络不正常&quot;<br />&nbsp;&nbsp;&nbsp; Else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; msgbox&nbsp; &quot;网络正常&quot;<br />&nbsp;&nbsp;&nbsp; End If<br />End Sub</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p></div></body></html>