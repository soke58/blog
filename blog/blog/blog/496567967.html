<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>用VB打造自己的电子书阅读器</title></head><body><h1>用VB打造自己的电子书阅读器</h1><div><p>使用前面一些日志的代码，制作了一个简单的HTM,HTML,TXT阅读器，因为自己有一些文档将近上万个，用网上的电子书制作软件制作，很费劲，有一次居然运行一个制作软件，由于读取文档数目过大，长时间未响应，弄得桌面的文件全部丢失了，系统崩溃，最后只好乖乖装系统，可惜好多资料没了。于是，自己便萌生制作这玩意的念头，电子书嘛，方便电脑阅读就行，既然如此VB就打造一个简单的阅读器。</p><p>&nbsp; &nbsp;VB6新建一个工程，在上面一次添加<span>Timer1,&nbsp;WebBrowser1,Label1,Label2,Dir1,Drive1,Text1,File1<span style="color: #000000; background-color: #f4f4f4; font-family: Arial;">这些控件，名字就按我列的这样，默认就可以了，然后在代码框选择通用，然后贴下面代码：</span></span></p><p></p><p><span style="color: #ff0000;">Dim URL As String</span></p><p><span style="color: #ff0000;">Dim picname As String, picno As Integer</span></p><p><span style="color: #ff0000;">Dim form_w '定义变量，用于记录调整前长与宽</span></p><p><span style="color: #ff0000;">Dim title As String '用于提取网页文件的标题</span></p><p><span style="color: #ff0000;">Dim form_h</span></p><p><span style="color: #ff0000;">Private Sub File1_Click()</span></p><p><span style="color: #ff0000;">On Error Resume Next</span></p><p><span style="color: #ff0000;">'**************下面这段代码提取当前文件的名称及路径</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp;picno = File1.ListIndex</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp;File1.Selected(picno) = True</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp;If Right(Trim(Dir1.Path), 1) = &quot;\&quot; Then</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; &nbsp;picname = Dir1.Path &amp; File1.List(picno)</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp;Else</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; &nbsp;picname = Dir1.Path &amp; &quot;\&quot; &amp; File1.List(picno) '这里PICNAME是所选的文件具体路径</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">&nbsp; End If</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">&nbsp;'**************</span></p><p><span style="color: #ff0000;">&nbsp; URL = picname '引用文件路径，给浏览器WebBrowser1打开</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">If LCase(Right(File1.FileName, 4)) = &quot;.htm&quot; Or LCase(Right(File1.FileName, 4)) = &quot;.txt&quot; Or LCase(Right(File1.FileName, 4)) = &quot;.html&quot; _</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp;Or LCase(Right(File1.FileName, 4)) = &quot;.html&quot; Then &nbsp;'这里判断是所选的文件格式，如果不是HTM格式则不用浏览器打开</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp;WebBrowser1.Navigate2 URL</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">End Sub</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Private Sub drive1_Change()</span></p><p><span style="color: #ff0000;">&nbsp;Dir1.Path = Drive1.Drive</span></p><p><span style="color: #ff0000;">End Sub</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Private Sub dir1_Change()</span></p><p><span style="color: #ff0000;">&nbsp;File1.Path = Dir1.Path</span></p><p><span style="color: #ff0000;">End Sub</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Private Sub Form_Load()</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">form_w = Form1.Width '记录初始长宽</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">form_h = Form1.Height</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">End Sub</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Private Sub Form_Resize()</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">On Error Resume Next</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">bl_W = Form1.Width / form_w '计算调整比例</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">bl_h = Form1.Height / form_h</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">WebBrowser1.Width = WebBrowser1.Width * bl_W '与上同理</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">WebBrowser1.Left = WebBrowser1.Left * bl_W</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">WebBrowser1.Height = WebBrowser1.Height * bl_h</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">WebBrowser1.Top = WebBrowser1.Top * bl_W</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">File1.Width = File1.Width * bl_W '与上同理</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">File1.Left = File1.Left * bl_W</span></p><p>&nbsp;</p><p>&nbsp;</p><p><span style="color: #ff0000;">File1.Top = File1.Top * bl_W</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Drive1.Left = Drive1.Left * bl_W '与上同理</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Drive1.Top = Drive1.Top * bl_W</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Dir1.Left = Dir1.Left * bl_W '与上同理</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Dir1.Top = Dir1.Top * bl_W</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Label1.Width = Label1.Width * bl_W '与上同理</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Label1.Left = Label1.Left * bl_W</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Label1.Height = Label1.Height * bl_h</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Label1.Top = Label1.Top * bl_W</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Label2.Width = Label2.Width * bl_W '与上同理</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Label2.Left = Label2.Left * bl_W</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Label2.Height = Label2.Height * bl_h</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Label2.Top = Label2.Top * bl_W</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Text1.Left = Text1.Left * bl_W '与上同理</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Text1.Top = Text1.Top * bl_W</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">form_w = Form1.Width '记录当前窗体尺寸,用于下一次调整时计算比例用.</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">form_h = Form1.Height</span></p><p><span style="color: #ff0000;">End Sub</span></p><p><span style="color: #ff0000;">Private Sub Label1_Click()</span></p><p><span style="color: #ff0000;">On Error Resume Next</span></p><p><span style="color: #ff0000;">If Text1.Text &lt;&gt; &quot;&quot; And Text1.Text &lt;&gt; &quot;&quot; And IsNumeric(Text1.Text) Then</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If Label1.Caption = &quot;【点此启动自动阅读】&quot; Then</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Timer1.Interval = Val(Text1.Text) * 60000</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Label1.Caption = &quot;【点此停止自动阅读】&quot;</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If File1.ListIndex = &quot;&quot; Then</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; File1.ListIndex = 1</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Timer1.Enabled = True</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Else</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Label1.Caption = &quot;【点此启动自动阅读】&quot;</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Timer1.Enabled = False</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">End Sub</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Private Sub Label3_Click()</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">End Sub</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Private Sub Timer1_Timer()</span></p><p><span style="color: #ff0000;">&nbsp;On Error Resume Next</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">If Label1.Caption = &quot;【点此启动自动阅读】&quot; Then '如果没点击按钮则时间控件未触发</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">&nbsp;Timer1.Enabled = False</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Else</span></p><p><span style="color: #ff0000;">&nbsp;Form1.Caption = &quot;网页文本阅读器&quot;</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">'**************下面代码实现依次自动读取列表filelist文件</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">&nbsp; &nbsp;Dim f As Integer</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">&nbsp; &nbsp;If File1.ListIndex = File1.ListCount - 1 Then '如果执行完退出</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">&nbsp; &nbsp;Timer1.Enabled = False</span></p><p><span style="color: #ff0000;">&nbsp;&nbsp;</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp;Else</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp;For f = File1.ListCount - 1 To 0 Step -1</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp;If File1.Selected(f) &lt;&gt; 0 Then '判断如果FILELIST选择值为TURE时，防止为零时始终选第一个文件</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp;File1.Selected(f) = File1.Selected(f) + 1 '不为零时递加选择下一个文件</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp;Else</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp;File1.Selected(f) = File1.Selected(f - 1) &nbsp; '选择下一个文件</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">&nbsp; &nbsp; &nbsp;End If</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp; Next</span></p><p><span style="color: #ff0000;">End If</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">End If</span></p><p><span style="color: #ff0000;">End Sub</span></p><p>&nbsp;</p><p><span style="color: #ff0000;">Private Sub WebBrowser1_DocumentComplete(ByVal pDisp As Object, URL As Variant)</span></p><p><span style="color: #ff0000;">title = WebBrowser1.Document.getelementsbytagname(&quot;title&quot;)(0).innerText</span></p><p><span style="color: #ff0000;">&nbsp; If title = &quot;&quot; Then</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp;Form1.Caption = &quot;网页文本阅读器&quot;</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp;Else</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp;Form1.Caption = title</span></p><p><span style="color: #ff0000;">&nbsp; &nbsp;End If</span></p><p><span style="color: #ff0000;">End Sub</span></p><p><span style="color: #000000;">看看效果图：</span></p><p><span style="color: #000000;"><span><img src="http://hiphotos.baidu.com/super58/pic/item/dae0a5c4b74543a9efba14841e178a82bb0114ca.jpg" small="0" /></span></span></p><p><span style="color: #000000;">源码下载地址：<a href="http://3gqq.ys168.com" target="_blank">http://3gqq.ys168.com</a>。唉可悲的是，360居然给上面的代码报毒，我奇怪了，无形当中菜鸟VB“被”成木马黑客了。<br /></span></p><p></p><p></p></div></body></html>