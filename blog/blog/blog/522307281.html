<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>VB网页源码操作之一：快速获取网页源码</title></head><body><h1>VB网页源码操作之一：快速获取网页源码</h1><div><p>呼呼，源码不小心被删了，擦，总结一些百度网上找的函数使用吧。</p><pre>调用方法是</pre><p></p><p></p><p>&nbsp;Private Sub Form_Load()<br />url = &quot;http://www.baidu.com/&quot;<br />RichTextBox1.text = GetBody(url) '最好用richbox富文本框<br />End Sub<br />'如果出现乱码，UTF-8可改为GB2312<br /><br />Public Function GetBody(ByVal URL$, Optional ByVal Coding$ = &quot;UTF-8&quot;)<br />Dim ObjXML<br />On Error Resume Next<br />Set ObjXML = CreateObject(&quot;Microsoft.XMLHTTP&quot;)<br />With ObjXML<br />.Open &quot;Get&quot;, URL, False, &quot;&quot;, &quot;&quot;<br />.setRequestHeader &quot;If-Modified-Since&quot;, &quot;0&quot;<br />.Send<br />GetBody = .ResponseBody<br />End With<br />GetBody = BytesToBstr(GetBody, Coding)<br />Set ObjXML = Nothing<br />End Function<br /><br />Public Function BytesToBstr(strBody, CodeBase)<br />Dim ObjStream<br />Set ObjStream = CreateObject(&quot;Adodb.Stream&quot;)<br />With ObjStream<br />.Type = 1<br />.Mode = 3<br />.Open<br />.Write strBody<br />.Position = 0<br />.Type = 2<br />.Charset = CodeBase<br />BytesToBstr = .ReadText<br />.Close<br />End With<br />Set ObjStream = Nothing<br />End Function</p><p>解决乱码问题可以设置两个按钮，一个按钮调用UTF-8函数的，一个是调用GB2312的</p></div></body></html>