<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>VB网页源码操作之二：提取取网页源码中标题等指定标签值</title></head><body><h1>VB网页源码操作之二：提取取网页源码中标题等指定标签值</h1><div><p>接着VB网页源码操作之一的，代码继续，下面一段是我从网上找的过滤图片函数稍微修改后，用于提取网页源码中的meta标签内容：</p><p>Public Function picFilter(downCode)<br /><br />Dim pStart As Long, pStop As Long<br /><br />Dim pString1 As String, pString2 As String<br /><br />pString1 = &quot;&lt;meta name=&quot;<br /><br />pString2 = &quot;/&gt;&quot;<br /><br />'分别将两个关键词定义<br /><br />pStart = InStr(downCode, pString1) + 34&nbsp; '这里的34是用于过滤字符串&quot;description&quot; content=&quot;的长度，包括空格，如果是别的标签可另设数值<br />'找到第一个meta信息的起始位置<br />If pStart &lt;&gt; 0 Then<br />'如果代码中有这个标签信息的话<br />pStop = InStr(pStart, downCode, pString2) - 2 ’这个2是过滤字符串/&gt;的<br />'从上面找的起始部位开始找到第一个用于结束meta信息的“/&gt;”<br />downCode = Mid(downCode, pStart, pStop - pStart)<br />pStop = InStr(pStart, downCode, pString2, 1) + 1<br />End If<br />picFilter = downCode<br />End Function</p><p>&nbsp;</p><p>函数调用：</p><p>假如我们通过函数GetBody( )获得源码GetBody(url)</p><p>msgbox picFilter(GetBody(url))</p><p>&nbsp;</p><p>同理我们也可以提取标题：</p><p>Public Function picFilter(downCode)<br />Dim pStart As Long, pStop As Long<br />Dim pString1 As String, pString2 As String<br />pString1 = &quot;&lt;title&gt;&quot;<br />pString2 = &quot;&lt;title/&gt;&quot;<br />'分别将两个关键词定义<br />pStart = InStr(downCode, pString1) + 7&nbsp; <br />'找到标题信息的起始位置<br />If pStart &lt;&gt; 0 Then<br />pStop = InStr(pStart, downCode, pString2) <br />downCode = Mid(downCode, pStart, pStop - pStart)<br />pStop = InStr(pStart, downCode, pString2, 1) + 1<br />End If<br />picFilter = downCode<br />End Function</p><p>如果这两个函数同时使用的时候最好修改一下定义参数名称，调用的时候最好picFilter(源码函数)，而不是先a=源码函数，再picFilter(a)。</p><p>这样有些网站容易提取空白值，具体我也不知道原因，经过好久琢磨才发现这样做才解决问题。</p></div></body></html>