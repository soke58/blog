<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>用VB打造自己的MP3播放器方法一</title></head><body><h1>用VB打造自己的MP3播放器方法一</h1><div><p>&nbsp; 首先我们得下载一个控件 Mp3play.ocx&nbsp;，因为本人不想用那个系统自带的播放器控件。</p><p>系统文件之家Mp3play.ocx控件1.4 新版下载:<a href="http://www.dllfiles-download.com/data/soft/5361.html" target="_blank">http://www.dllfiles-download.com/data/soft/5361.html</a></p><p><span style="color: #ff0000;">一、如果您的系统提示“没有找到Mp3play.ocx”或者“缺少Mp3play.ocx”等类似错误信息，请把Mp3play.ocx下载到本机</span></p><p><span style="color: #ff0000;">二、直接拷贝该文件到系统目录里：</span></p><p><span style="color: #ff0000;">　　 1、Windows 95/98/Me系统，则复制到C:WindowsSystem目录下。</span></p><p><span style="color: #ff0000;">　　 2、Windows NT/2000系统，则复制到C:WINNTSystem32目录下。</span></p><p><span style="color: #ff0000;">　　 3、Windows XP系统，则复制到C:WindowsSystem32目录下。</span></p><p><span style="color: #ff0000;">三、然后打开“开始-运行-输入regsvr32 Mp3play.ocx”，回车即可解决错误提示！</span></p><p>&nbsp; &nbsp; &nbsp;&nbsp;上面是引用那个网站的描述，我下载完后，解压到C:\WINDOWS\system文件下。我的XP系统曾经把它解压到system32目录下，VB6.0不能显示该控件名称,于是就换到system目录下，重新打开VB6.O成功显示该控件。解压完后，然后第三步执行，开始-运行-输入regsvr32 Mp3play.ocx，回车提示注册成功。</p><p>由于该控件需要注册才能完全使用，</p><p>网上搜索得到的注册码如下：</p><p><span style="color: #ff0000;">MP3PLAY 1.4 新版, 播放MP3的控件。&nbsp;</span></p><p><span style="color: #ff0000;">注册码：name/ ufo2000 sn/ 1208686909&nbsp;</span></p><p><span style="color: #ff0000;">注册方法:&nbsp;</span></p><p><span style="color: #ff0000;">调用该控件,用该控件的 Authorize 属性 具体做法为&nbsp;</span></p><p><span style="color: #ff0000;">I=mp3play1.Authorize 注册名,注册码 (返回 I=0 即表示注册成功,每次调用都必须注册)&nbsp;</span></p><p><span style="color: #ff0000;">所以在VB工程代码中只有我们加入下面这串代码就行（不加的话，所播放的歌曲只能播放30秒）</span></p><p><span style="color: #ff0000;">I=Mp3Play1.Authorize(&quot;ufo2000&quot;, &quot;1208686909&quot;)&nbsp;</span></p><p>【另付该控件其他版本注册码】：</p><p>MP3Play &nbsp; ActiveX &nbsp; Control &nbsp; v1.1 &nbsp; : &nbsp; Name: &nbsp; PLAY3836451 &nbsp; s/n: &nbsp; 956515 &nbsp; (include &nbsp;&nbsp;</p><p>&nbsp;mp3play1.Authorize &nbsp; &quot;PLAY3836451 &quot;, &nbsp; &quot;956515 &quot;)&nbsp;</p><p>&nbsp;MP3Play &nbsp; ActiveX &nbsp; Control &nbsp; v1.2 &nbsp; : &nbsp; Name: &nbsp; PLAY3826451 &nbsp; s/n: &nbsp; 956515 &nbsp; (include &nbsp;&nbsp;</p><p>&nbsp;mp3play1.Authorize &nbsp; &quot;PLAY3836451 &quot;, &nbsp; &quot;956515 &quot;)&nbsp;</p><p>&nbsp;MP3Play &nbsp; v1.5 &nbsp; : &nbsp; Name: &nbsp; PLAY3326782111 &nbsp; s/n: &nbsp; 4796646</p><p>&nbsp; &nbsp; &nbsp;&nbsp;&nbsp;到这里我们基本上已经完成了一半了，下面就给大家摘录一段网上的制作过程：</p><p></p><p><span style="color: #ff0000;">1． 添加Mp3Play.ocx控件</span></p><p><span style="color: #ff0000;">启动VB5,选择Standard EXE。此时，左边的控件面板中只是一些Win95标准控件。</span></p><p><span style="color: #ff0000;">我们选Project（工程）</span><span style="color: #ff0000;">菜单下的Components...(组件)项，在弹出的对话框中选中Dialog－Medien Mp3Play ActiveX Control&nbsp;</span><span style="color: #ff0000;">Module项。这“宝贝”即我们所需的MP3控件。确定后在控件面板中会增添一个蓝色的喇叭图标，表示该</span><span style="color: #ff0000;">控件已经添加到控件面板中。&nbsp;</span></p><p><span style="color: #ff0000;">2． 设置属性</span><span style="color: #ff0000;">点中蓝色喇叭，在窗体中拖动一个矩形框，松开后在窗体中出现MP3控件图标。为了在播放时隐去喇叭，</span><span style="color: #ff0000;">在MP3Play1的属性表中将Visible设为False。一般就这么多，剩下的就是使用它的方法(Methods)了。</span></p><p><span style="color: #ff0000;"> 3</span><span style="color: #ff0000;">． 添加按钮</span><span style="color: #ff0000;">点中“Command”按钮，在窗体中建立三个名字分别为Command1、Command2、Command3的命令按钮，将它</span><span style="color: #ff0000;">们的Caption分别设为“选择MP3文件”、“播放”、“暂停”。 4． 添加CommonDialog控件</span><span style="color: #ff0000;">为能方便地选择MP3 文件，还需文件打开对话框。如果控件面板中没有此控件，如1中所述选中</span><span style="color: #ff0000;">Components菜单项，在Microsoft Common Dialog Control 5.0前的复选框中打勾，确认后即可在控件面</span><span style="color: #ff0000;">板中看到此控件图标。在窗体中建立一个名为CommonDialog1的对象。</span></p><p><span style="color: #ff0000;">5． 在按钮中编写相应的代码</span></p><p><span style="color: #ff0000;">双击Command1，在Private Sub Command1_Click()中输入以下代码： CommonDialog1.ShowOpen</span></p><p><span style="color: #ff0000;">双击Command2，在Private Sub Command2_Click()中输入：</span></p><p><span style="color: #ff0000;"> Err = Mp3Play1.Open</span><span style="color: #ff0000;">(CommonDialog1.filename, ″″)</span></p><p><span style="color: #ff0000;"> Mp3Play1.Play</span></p><p><span style="color: #ff0000;">双击Command3，在Private Sub Command3_Click()中输入：&nbsp;</span></p><p><span style="color: #ff0000;">Mp3Play1.Pause</span></p><p><span style="color: #ff0000;">6．调整窗口大小，运行播放器</span></p><p><span style="color: #ff0000;">适当调整窗体的外观，如大小、颜色等，怎么舒服您就怎么设置。好了，开始按F5运行，选择MP3文件—</span><span style="color: #ff0000;">—播放！感受一下您自个儿的MP3播放器吧！ 此外，您还可以用Photoshop等软件制作一些漂亮的界面，</span><span style="color: #ff0000;">贴在窗体上，增强其艺术性。还可以仿照Winamp的“Plug_ins”，利用Timer控件完成一些特殊的动画效</span><span style="color: #ff0000;">果。当然，一切都靠您自个的天才去设计了。</span></p><p>上面的5.0版本，在6.0版本完全可以实现，按上面的做法只能播放30秒歌曲，所以我们得加上注册码。这是我制作的测试软件截图，稍微加了显示文件名的提示和注册码。</p><p><span><img src="http://hiphotos.baidu.com/super58/pic/item/530a7487e950352a708ae3405343fbf2b0118b8d.jpg" small="0" /></span></p><p>代码如下：</p><p></p><p><span style="color: #0055ff;">Private Sub Command1_Click()</span></p><p><span style="color: #0055ff;">CommonDialog1.ShowOpen</span></p><p><span style="color: #0055ff;">End Sub</span></p><p>&nbsp;</p><p><span style="color: #0055ff;">Private Sub Command2_Click()</span></p><p><span style="color: #0055ff;">&nbsp;Err = Mp3Play1.Open(CommonDialog1.FileName, ″″)</span></p><p><span style="color: #0055ff;">&nbsp;Mp3Play1.Play</span></p><p><span style="color: #0055ff;">&nbsp;I = Mp3Play1.Authorize(&quot;ufo2000&quot;, &quot;1208686909&quot;)</span></p><p></p><p><span style="color: #0055ff;">Print CommonDialog1.FileName</span></p><p><span style="color: #0055ff;">End Sub</span></p><p><span style="color: #0055ff;"><br /></span></p><p><span style="color: #0055ff;">Private Sub Command3_Click()</span></p><p><span style="color: #0055ff;">Mp3Play1.Pause</span></p><p><span style="color: #0055ff;">End Sub</span></p><div></div>不过这样做出来的播放器对现在的音乐文件支持不怎么好，也许因为这个控件解码不怎么好。</div></body></html>