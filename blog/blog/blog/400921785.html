<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>ASP如何制做验证码</title></head><body><h1>ASP如何制做验证码</h1><div><p>步骤一，将下面的代码全部复制到一个空白ASP文件里面，并另存为checkcode.asp<br>&lt;%<br>Option Explicit<br>Response.buffer=true<br>NumCode<br>Function NumCode()<br>&nbsp;Response.Expires = -1<br>&nbsp;Response.AddHeader "Pragma","no-cache"<br>&nbsp;Response.AddHeader "cache-ctrol","no-cache"<br>&nbsp;On Error Resume Next<br>&nbsp;Dim zNum,i,j<br>&nbsp;Dim Ados,Ados1<br>&nbsp;Randomize timer<br>&nbsp;zNum = cint(8999*Rnd+1000)<br>&nbsp;Session("CheckCode") = zNum<br>&nbsp;Dim zimg(4),NStr<br>&nbsp;NStr=cstr(zNum)<br>&nbsp;For i=0 To 3<br>&nbsp;&nbsp;zimg(i)=cint(mid(NStr,i+1,1))<br>&nbsp;Next<br>&nbsp;Dim Pos<br>&nbsp;Set Ados=Server.CreateObject("Adodb.Stream")<br>&nbsp;Ados.Mode=3<br>&nbsp;Ados.Type=1<br>&nbsp;Ados.Open<br>&nbsp;Set Ados1=Server.CreateObject("Adodb.Stream")<br>&nbsp;Ados1.Mode=3<br>&nbsp;Ados1.Type=1<br>&nbsp;Ados1.Open<br>&nbsp;Ados.LoadFromFile(Server.mappath("body.Fix"))<br>&nbsp;Ados1.write Ados.read(1280)<br>&nbsp;For i=0 To 3<br>&nbsp;&nbsp;Ados.Position=(9-zimg(i))*320<br>&nbsp;&nbsp;Ados1.Position=i*320<br>&nbsp;&nbsp;Ados1.write ados.read(320)<br>&nbsp;Next&nbsp;<br>&nbsp;Ados.LoadFromFile(Server.mappath("head.fix"))<br>&nbsp;Pos=lenb(Ados.read())<br>&nbsp;Ados.Position=Pos<br>&nbsp;For i=0 To 9 Step 1<br>&nbsp;&nbsp;For j=0 To 3<br>&nbsp;&nbsp;&nbsp;Ados1.Position=i*32+j*320<br>&nbsp;&nbsp;&nbsp;Ados.Position=Pos+30*j+i*120<br>&nbsp;&nbsp;&nbsp;Ados.write ados1.read(30)<br>&nbsp;&nbsp;Next<br>&nbsp;Next<br>&nbsp;Response.ContentType = "images/BMP" <br>&nbsp;Ados.Position=0<br>&nbsp;Response.BinaryWrite Ados.read()<br>&nbsp;Ados.Close:set Ados=nothing<br>&nbsp;Ados1.Close:set Ados1=nothing<br>&nbsp;If Err Then Session("CheckCode") = 9999<br>End Function<br>%&gt;</p>
<p>步骤二，将body.Fix和Head.Fix两个文件和checkcode.asp放在同一目录下，至于body.Fix和Head.Fix这两个文件可以网上搜索，好像有和这个代码对应的。本人也有如果需要请留下E-MAIL，有空发给你。</p>
<p>步骤三，在需要安装验证码的页面插入这个输入框</p>
<p>&nbsp;&lt;/tr&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt; <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td height="20" class="style5" width="23%"&gt;&lt;font face="黑体"&gt;&lt;b&gt;&amp;nbsp;&lt;/b&gt;验证码<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;：&lt;/font&gt;&lt;/td&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td class="style3" colspan="2"&gt;&lt;input name="yznum" type=text id="yznum"&gt;&lt;img src="checkcode.asp" alt="看不清楚?请点击刷新"&nbsp; onclick="this.src=this.src+'?'+Math.random();" style="CURSOR:hand;"&gt;&lt;/td&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</p>
<p>步骤三，验证码的判断。在写入数据库的页面前加上这个<br>&lt;%<br>yznum=trim(request.form("yznum"))<br>if yznum&lt;&gt;"" then<br>if int(Session("CheckCode"))&lt;&gt;int(yznum) then<br>response.write "&lt;Script&gt;window.alert('验证码错误！');history.go(-1);&lt;/Script&gt;"<br>end if<br>else<br>response.write "&lt;Script&gt;window.alert('请输入验证码！');history.go(-1);&lt;/Script&gt;"<br>end if<br>%&gt;</p>
<p>【柳子木搜集制作，代码来自互联网，本人只是总结规整拼凑搜藏，以免遗忘】</p></div></body></html>